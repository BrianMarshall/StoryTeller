<html>
	<head>
		<title>StoryTeller Test</title>
		<style>
.page {	display: none;}
.error {color: #FF0000;}
		</style>        
        <script type="text/javascript"  src="../source/util.js"></script>
        <script type="text/javascript"  src="../source/types.js"></script>
        <script type="text/javascript"  src="../source/random.js"></script>
        <script type="text/javascript"  src="../source/base64.js"></script>
        <script type="text/javascript"  src="../source/state.js"></script>
		<script type="text/javascript"  src="../source/compiler.js"></script>
		<script type="text/javascript"  src="../source/core.js"></script>
		<script type="text/javascript">
var coordinates = {
  x : 0,
  y : 0,
  
  size : function() {return 20;},
  
  toInt16Array : function() {
   var ints = [[]];
   ints[[0]] = (this.x & 0x03FF) | ((this.y & 0x003F) << 10);
   ints[[1]] = (this.y & 0x03FF) >> 6;
   return ints;
  },
  
  fromInt16Array : function(ints) {
    this.x = ints[[0]] & 0x03FF;
    this.y = (ints[[0]] >> 10) | (ints[[1]] << 6);
  }
}        
        
var variables = [
    { name : "boolean", value : new BooleanVariable(false) },
    { name : "number", value : new NumberVariable(3.14159) },    
    { name : "integer1", value : new IntegerVariable(0, 65536, 0, false) },
    { name : "integer2", value : new IntegerVariable(-10, 10, 0, true) },
    { value : coordinates }
];

function setCoordinates(x,y) {
    coordinates.x = x;
    coordinates.y = y;
}

function coordinatesString() {
    return "(" + coordinates.x + ", " + coordinates.y + ")";
}

function forCount(block, item, from, to) {

    var body = "";
            
    for(var i=from.evaluate();i<=to.evaluate();i++) {
        item.assign(i);
        body += block.execute();
    }
    return body;
}

var functions = [
    { name: "setCoords", operation: setCoordinates },
    { name: "getCoords", operation: coordinatesString },
    { name: "for", operation: forCount, blockFunction: true}
];
		</script>
	</head>
	<body>    
        <div class="page" id="start">		
			<p>[randomBoolean(0.5)]</p>
			<p>[randomNumber(-1,1)]</p>
			<p>[randomInteger(0,100)]</p>
			<hr/>
            <h1>Page 1</h1>            
            <p>[boolean]</p>
            <p>[number]</p>
            <p>[integer1]</p>
            <p>[integer2]</p>
            <p>[getCoords()]</p>
            [boolean=true][number=2.71828][integer1=65536]
            [link("page2")][integer2=-7][setCoords(256,193)]to Page 2[end]
            [include("subpage")]
            <ol>
            [for($a,1,20)]
                <li>[$a]</li>
            [end]
            </ol>
            [$b=7]
            [if($b equal 7)]<p>YES</p>[end]
            [if($b equal 8)]<p>NO</p>[end]
            [if($b notEqual 8)]<p>YES</p>[end]
            [if($b notEqual 7)]<p>NO</p>[end]
            [if($b lessThan 8)]<p>YES</p>[else]<p>NO</p>[end]
            [if($b lessThan 7)]<p>NO</p>[else]<p>YES</p>[end]
			[if($b lessThanOrEqual 6)]<p>NO</p>[else if($b lessThanOrEqual 7)]<p>YES</p>[else]<p>NO</p>[end]
			[if($b greaterThan 7)]<p>NO</p>[else if($b greaterThan 6)]<p>YES</p>[else]<p>NO</p>[end]
			[if($b greaterThanOrEqual 7)]<p>YES</p>[else if($b greaterThanOrEqual 6)]<p>NO</p>[else]<p>NO</p>[end]
			[if(not($b lessThan 8))]<p>NO</p>[else]<p>YES</p>[end]
			<p>[1+2]</p>
			<p>[7-3]</p>
			<p>[5*9]</p>
			<p>[4/3]</p>
			<p>[integer2=-1][integer2]</p>
			<p>[integer2=-integer2][integer2]</p>
			<p>[1+6/2-8*0.25]</p>
			<p>[2*(7-1)/3]</p>			
        </div>
        <div class="page" id="page2">
            <h1>Page 2</h1>
            <p>[boolean]</p>
            <p>[number]</p>
            <p>[integer1]</p>
            <p>[integer2]</p>
            <p>[getCoords()]</p>
            [($a,$b,$c)=(1,"b",1.23)]
            <ul>
            <li>[$a]</li>
            <li>[$b]</li>
            <li>[$c]</li>
            </ul>
            [$d=("Hello World",0.99,2)]
            [($a,$b,$c)=$d]
            <ul>
            <li>[$a]</li>
            <li>[$b]</li>
            <li>[$c]</li>
            </ul>
        </div>
        <div class="page" id="subpage">
            <h2>Sub-Page</h2>
            <p>[boolean]</p>
            <p>[number]</p>
            <p>[integer1]</p>
            <p>[integer2]</p>
            <p>[getCoords()]</p>
        </div>
	</body>
</html>